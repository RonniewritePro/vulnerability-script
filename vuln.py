import nmap

# Create a new Nmap scanner object
scanner = nmap.PortScanner()

# Set the IP address or hostname to scan
target = "41.72.214.214"

# Set the options for the scan (in this case, enable version detection and vulnerability scanning)
scan_args = "-sV --script vuln"

# Perform the scan
scanner.scan(target, arguments=scan_args)

# Print the results
for host in scanner.all_hosts():
    print("Host: %s (%s)" % (host, scanner[host].hostname()))
    print("State: %s" % scanner[host].state())
    for proto in scanner[host].all_protocols():
        print("Protocol: %s" % proto)
        ports = scanner[host][proto].keys()
        for port in ports:
            print("Port: %s\tState: %s\tService: %s" % (port, scanner[host][proto][port]['state'], scanner[host][proto][port]['name']))
            if 'script' in scanner[host][proto][port] and 'vuln' in scanner[host][proto][port]['script']:
                print("Results: %s" % scanner[host][proto][port]['script']['vuln'])
            else:
                print("No vulnerability scan results for port %s" % port)
